---
layout: post
title: "EF Code First 4.1  in Console Application"
date: 2011-08-04
comments: false
categories:
 - Data Access
 - Entity Framework
---

<div class='post'>
<div dir="ltr" style="text-align: left;" trbidi="on"><div class="MsoNormal" style="margin: 0in 0in 10pt; text-align: justify;"><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;">Whenever I learn any new things in .Net or experimenting with something, I always prefer to use <b style="mso-bidi-font-weight: normal;">Console Applications. </b>I personally feel it helps me to concentrate more on what actually I am trying to learn or experiment without any sort of distractions. Moreover it keeps things simple. </span></span></div><div class="MsoNormal" style="margin: 0in 0in 10pt; text-align: justify;"><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>I would like to do the same while learning EF Code First 4.1. Though most of articles in web explain EF with respect to ASP.NET MVC, I favor learning it through my own way using console application without creating any controllers and views!!</span></span></div><div class="MsoNormal" style="margin: 0in 0in 10pt; text-align: justify;"><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;">Following are the prerequisites to work with EF Code First 4.1.</span></span></div><div class="MsoListParagraphCxSpFirst" style="margin: 0in 0in 0pt 69pt; mso-add-space: auto; mso-list: l0 level1 lfo1; text-align: justify; text-indent: -0.25in;"><span style="font-family: Symbol; font-size: 12pt; line-height: 115%; mso-bidi-font-family: Symbol; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: Symbol;"><span style="mso-list: Ignore;">·<span style="font: 7pt 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><a href="http://weblogs.asp.net/scottgu/archive/2011/03/15/visual-studio-2010-sp1.aspx"><span style="color: purple; font-family: Calibri;">Visual Studio 2010 SP1</span></a></span></div><div class="MsoListParagraphCxSpMiddle" style="margin: 0in 0in 0pt 69pt; mso-add-space: auto; mso-list: l0 level1 lfo1; text-align: justify; text-indent: -0.25in;"><span style="font-family: Symbol; font-size: 12pt; line-height: 115%; mso-bidi-font-family: Symbol; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: Symbol;"><span style="mso-list: Ignore;">·<span style="font: 7pt 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><a href="http://blogs.msdn.com/b/adonet/archive/2011/04/11/ef-4-1-released.aspx"><span style="color: purple; font-family: Calibri;">Entity Framework 4.1</span></a></span></div><div class="MsoListParagraphCxSpLast" style="margin: 0in 0in 10pt 69pt; mso-add-space: auto; mso-list: l0 level1 lfo1; text-align: justify; text-indent: -0.25in;"><span style="font-family: Symbol; font-size: 12pt; line-height: 115%; mso-bidi-font-family: Symbol; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: Symbol;"><span style="mso-list: Ignore;">·<span style="font: 7pt 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><a href="http://weblogs.asp.net/scottgu/archive/2011/01/11/vs-2010-sp1-and-sql-ce.aspx"><span style="color: purple; font-family: Calibri;">SQL CE</span></a><span style="font-family: Calibri;"> or SQL Express (SQL CE would be an ideal option for learning purpose)</span></span></div><div class="MsoNormal" style="margin: 0in 0in 10pt; text-align: justify;"><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;">Let’s go and create the console application.</span></span></div><div class="MsoNormal" style="margin: 0in 0in 10pt; text-align: justify; text-indent: 0.5in;"><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;">After creating a console application project, the initial step would be adding references to the following assemblies.</span></span></div><div class="MsoListParagraphCxSpFirst" style="margin: 0in 0in 0pt 0.75in; mso-add-space: auto; mso-list: l1 level1 lfo2; text-align: justify; text-indent: -0.25in;"><span style="font-family: Symbol; font-size: 12pt; line-height: 115%; mso-bidi-font-family: Symbol; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: Symbol;"><span style="mso-list: Ignore;">·<span style="font: 7pt 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;">EntityFramework (Version 4.1)</span></span></div><div class="MsoListParagraphCxSpMiddle" style="margin: 0in 0in 0pt 0.75in; mso-add-space: auto; mso-list: l1 level1 lfo2; text-align: justify; text-indent: -0.25in;"><span style="font-family: Symbol; font-size: 12pt; line-height: 115%; mso-bidi-font-family: Symbol; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: Symbol;"><span style="mso-list: Ignore;">·<span style="font: 7pt 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;">System.Data.Entity</span></span></div><div class="MsoListParagraphCxSpMiddle" style="background: white; line-height: normal; margin: 0in 0in 0pt 0.75in; mso-add-space: auto; mso-list: l1 level1 lfo2; tab-stops: 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt; text-indent: -0.25in;"><span style="font-family: Symbol; font-size: 12pt; mso-bidi-font-family: Symbol; mso-bidi-font-size: 11.0pt; mso-fareast-font-family: Symbol;"><span style="mso-list: Ignore;">·<span style="font: 7pt 'Times New Roman';">&nbsp;&nbsp; </span></span></span><span style="font-size: 12pt; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;"><span style="mso-spacerun: yes;">&nbsp;&nbsp;&nbsp;</span>System.ComponentModel.DataAnnotations</span></span></div><div class="MsoListParagraphCxSpLast" style="margin: 0in 0in 10pt 0.75in; mso-add-space: auto; text-align: justify;"><br /></div><div class="MsoNormal" style="margin: 0in 0in 10pt; text-align: justify; text-indent: 0.5in;"><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;">Now it’s time to defining the model and the data context. To keep it simple, I am going to define only one model “User”.</span></span></div><div class="separator" closure_uid_3qx5l0="188" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-FxoouXlWKxw/TjqAva1qsWI/AAAAAAAAAJM/5PLCVnNFhDQ/s1600/User.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="260px" src="http://4.bp.blogspot.com/-FxoouXlWKxw/TjqAva1qsWI/AAAAAAAAAJM/5PLCVnNFhDQ/s320/User.PNG" t$="true" width="320px" /></a><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span closure_uid_3qx5l0="161" style="font-family: Calibri;"><span closure_uid_3qx5l0="160" style="mso-spacerun: yes;"></span></span></span></div><div class="separator" closure_uid_3qx5l0="188" style="clear: both; text-align: center;"><br /></div><div class="separator" closure_uid_3qx5l0="188" style="clear: both; text-align: center;"><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span closure_uid_3qx5l0="161" style="font-family: Calibri;"><span closure_uid_3qx5l0="160" style="mso-spacerun: yes;">&nbsp;</span></span></span><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;">The data context would be as following.</span></span></div><div class="separator" style="clear: both; text-align: center;"></div><br /><div class="separator" style="clear: both; text-align: center;"></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-2pLPCQePVKY/TjqAwJ-QD4I/AAAAAAAAAJU/X66hDdCw6eo/s1600/MyDataContext.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="169px" src="http://3.bp.blogspot.com/-2pLPCQePVKY/TjqAwJ-QD4I/AAAAAAAAAJU/X66hDdCw6eo/s320/MyDataContext.PNG" t$="true" width="320px" /></a></div><div class="MsoNormal" closure_uid_3qx5l0="164" style="margin: 0in 0in 10pt; text-align: justify; text-indent: 0.5in;"><br /></div><div class="MsoNormal" style="margin: 0in 0in 10pt; text-align: justify; text-indent: 0.5in;"><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span closure_uid_3qx5l0="187" style="font-family: Calibri;">This basic infrastructure is sufficient to run the console application. However as we are using the data context for learning purpose, we might change the model often and doing so will make it inconsistent with the database created automatically when you run the application for the first time. We can circumvent this situation by creating new Data Context initialize class that inherits from DropCreateDatabaseIfModelChanges&lt;TContext&gt; where TContext is the data context that you want to sync with the database always. This class also offers an override function “Seed” using which we can fill the database with some initial data.</span></span></div><div class="MsoNormal" style="margin: 0in 0in 10pt; text-align: justify;"><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;">The finished code of DataContext initialize class will be like the following.</span></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-fFqQJzPBGkY/TjqAwOW4nMI/AAAAAAAAAJY/DDY_VyYQHfI/s1600/MyDataContextInit.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="262px" src="http://2.bp.blogspot.com/-fFqQJzPBGkY/TjqAwOW4nMI/AAAAAAAAAJY/DDY_VyYQHfI/s320/MyDataContextInit.PNG" t$="true" width="320px" /></a></div><div class="MsoNormal" closure_uid_3qx5l0="276" style="margin: 0in 0in 10pt; text-align: justify;"><br /></div><div class="MsoNormal" style="margin: 0in 0in 10pt; text-align: justify;"><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;">This datacontext initialize class would create the database whenever the database model changes and create two users by default. Now it’s time to code our Main method, which is actually to trigger all the actions!.</span></span></div><div class="MsoNormal" style="margin: 0in 0in 10pt; text-align: justify;"><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;">Here we go. Pay close attention to the first statement in the Main method that initializes the database with an instance of DataContextInit class that we have created.</span></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-jl5r5Sk7m0Q/TjqAvdAJRPI/AAAAAAAAAJQ/elZcjzTNgEE/s1600/EFConsoleApp.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="223px" src="http://4.bp.blogspot.com/-jl5r5Sk7m0Q/TjqAvdAJRPI/AAAAAAAAAJQ/elZcjzTNgEE/s320/EFConsoleApp.PNG" t$="true" width="320px" /></a></div><div class="MsoNormal" closure_uid_3qx5l0="282" style="margin: 0in 0in 10pt; text-align: justify;"><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;"><span closure_uid_3qx5l0="281" style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></div><div class="MsoNormal" closure_uid_3qx5l0="282" style="margin: 0in 0in 10pt; text-align: justify;"><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;"><span closure_uid_3qx5l0="281" style="mso-tab-count: 1;"></span></span></span><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;">Now you can run the application without any configurations. The default behavior of EF Code First will create the database with the same name as your data context name here “MyDataContext” in the SQL Express server installed in the local machine. If you wish to change this default behavior and wanted to use SQL CE instead of SQL Express just add an App.Config to the project and create a connection string with the name of your data context as follows.</span></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-YUZyAGX2KyA/TjqAvBuEd4I/AAAAAAAAAJI/p_UjE-K_lR8/s1600/Configuration.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="65px" src="http://4.bp.blogspot.com/-YUZyAGX2KyA/TjqAvBuEd4I/AAAAAAAAAJI/p_UjE-K_lR8/s320/Configuration.PNG" t$="true" width="320px" /></a></div><div class="MsoNormal" closure_uid_3qx5l0="284" style="margin: 0in 0in 10pt; text-align: justify; text-indent: 0.5in;"><br /></div><div class="MsoNormal" closure_uid_3qx5l0="284" style="margin: 0in 0in 10pt; text-align: justify; text-indent: 0.5in;"><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span closure_uid_3qx5l0="285" style="font-family: Calibri;">That’s it. “Ctrl+F5” and here is the output</span></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-l0IfgWCGZfQ/TjqAwX_8pnI/AAAAAAAAAJc/RLcjASqgaBo/s1600/Output.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="117px" src="http://3.bp.blogspot.com/-l0IfgWCGZfQ/TjqAwX_8pnI/AAAAAAAAAJc/RLcjASqgaBo/s320/Output.PNG" t$="true" width="320px" /></a></div><div class="MsoNormal" style="margin: 0in 0in 10pt; text-align: justify;"><br /></div><div class="MsoNormal" style="margin: 0in 0in 10pt; text-align: justify;"><b style="mso-bidi-font-weight: normal;"><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="font-family: Calibri;">Summary</span></span></b></div><div class="MsoNormal" style="margin: 0in 0in 10pt; text-align: justify;"><span style="font-family: Calibri;"><b style="mso-bidi-font-weight: normal;"><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;"><span style="mso-tab-count: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></b><span style="font-size: 12pt; line-height: 115%; mso-bidi-font-size: 11.0pt;">In this blog post we have explore the basic foundation on how to work with EF CodeFirst using console application. If you want to get your dirty with EF Code First without any distraction Console Application is a better one. You can download the sample code used in this blog post from <a href="http://www.box.net/shared/s0yu8b4sebp3dh9ru5gb">here.</a></span></span></div><div closure_uid_3qx5l0="120"></div></div></div>